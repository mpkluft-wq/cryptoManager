{% extends "default_layout/main_layout.html.twig" %}

{% block body %}
    <h1>üí≥ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h1>

    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div class="flash-{{ label }}">{{ message }}</div>
        {% endfor %}
    {% endfor %}

    <section>
        <h2>–°–ø–∏—Å–æ–∫</h2>
        {% if transactions is empty %}
            <p>–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>
        {% else %}
            <table border="1" cellpadding="6" cellspacing="0">
                <thead>
                <tr>
                    <th>–í—Ä–µ–º—è</th>
                    <th>–¢–∏–ø</th>
                    <th>–ë–∏—Ä–∂–∞</th>
                    <th>–ë–æ—Ç</th>
                    <th>–ê–∫—Ç–∏–≤</th>
                    <th>–ö–æ–ª-–≤–æ</th>
                    <th>–¶–µ–Ω–∞</th>
                    <th>–°—É–º–º–∞</th>
                    <th>–í–∞–ª—é—Ç–∞</th>
                    <th>–í–Ω–µ—à–Ω. ID</th>
                    <th>–ó–∞–º–µ—Ç–∫–∏</th>
                </tr>
                </thead>
                <tbody>
                {% for t in transactions %}
                    <tr>
                        <td>{{ t.timestamp|date('Y-m-d H:i:s') }}</td>
                        <td>{{ t.type.name }}</td>
                        <td>{{ t.exchangeId }}</td>
                        <td>{{ t.tradingBotId ?: '-' }}</td>
                        <td>{{ t.assetSymbol }}</td>
                        <td>{{ t.quantity }}</td>
                        <td>{{ t.pricePerUnit }}</td>
                        <td>{{ t.totalAmount }}</td>
                        <td>{{ t.currency }}</td>
                        <td>{{ t.externalTransactionId ?: '-' }}</td>
                        <td>{{ t.notes ?: '-' }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </section>

    <section style="margin-top: 24px;">
        <h2>–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h2>
        <form method="post" action="{{ path('transaction_list') }}">
            <div>
                <label>–í—Ä–µ–º—è (YYYY-MM-DD HH:MM:SS)</label><br>
                <input type="datetime-local" name="timestamp" step="1" placeholder="–ø—É—Å—Ç–æ = —Å–µ–π—á–∞—Å" />
            </div>
            <div>
                <label>–¢–∏–ø</label><br>
                <select name="type">
                    {% for t in transactionTypes %}
                        <option value="{{ t }}">{{ t }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label>–ë–∏—Ä–∂–∞ (exchangeId)</label><br>
                <select name="exchangeId" required>
                    {% for ex in exchanges %}
                        <option value="{{ ex.id }}">{{ ex.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label>–ë–æ—Ç (tradingBotId)</label><br>
                <input type="text" name="tradingBotId" />
            </div>
            <div>
                <label>–ê–∫—Ç–∏–≤ (assetSymbol)</label><br>
                <input type="text" name="assetSymbol" required list="assetSymbolsList" />
                <datalist id="assetSymbolsList">
                    {% for s in assetSymbols %}
                        <option value="{{ s }}">{{ s }}</option>
                    {% endfor %}
                </datalist>
                <div style="margin-top: 6px; font-size: 90%; color: #555;">
                    –î–æ—Å—Ç—É–ø–Ω—ã–µ –∞–∫—Ç–∏–≤—ã: 
                    {% if assetSymbols is not empty %}
                        {{ assetSymbols|join(', ') }}
                    {% else %}
                        –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ CryptoCurrency
                    {% endif %}
                </div>
            </div>
            <div>
                <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (quantity)</label><br>
                <input type="number" step="any" name="quantity" required />
            </div>
            <div>
                <label>–¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É (pricePerUnit)</label><br>
                <input type="number" step="any" name="pricePerUnit" required />
            </div>
            <div>
                <label>–°—É–º–º–∞ (totalAmount)</label><br>
                <input type="number" step="any" name="totalAmount" required />
            </div>
            <div>
                <label>–í–∞–ª—é—Ç–∞</label><br>
                <input type="text" name="currency" required />
            </div>
            <div>
                <label>–í–Ω–µ—à–Ω–∏–π ID</label><br>
                <input type="text" name="externalTransactionId" />
            </div>
            <div>
                <label>–ó–∞–º–µ—Ç–∫–∏</label><br>
                <textarea name="notes" rows="2"></textarea>
            </div>

            <div style="margin-top: 12px;">
                <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
        </form>
    </section>
{% endblock %}
